<template>
  <div>
    <main>
      <div class="offer pb-[64px] md:pb-[120px] relative w-full min-h-screen overflow-hidden offer_bgLinear__vFptl">
        <div class="css-1km3mtt ant-app">
          <div class="relative z-20 h-[187px] md:h-[309px] lg:h-[285px] bg-no-repeat">
            <picture>
              <source srcset="/images/bitget/banner-bg.3eef0521.svg" media="(min-width: 1px) and (max-width: 640px)">
              <source srcset="/images/bitget/banner-bg-md.5e0624e6.svg"
                      media="(min-width: 641px) and (max-width: 768px)">
              <source srcset="/images/bitget/banner-bg-lg.4bf2e9d5.svg"
                      media="(min-width: 769px) and (max-width: 1024px)">
              <source srcset="/images/bitget/banner-bg-2xl.8d79a9b3.svg"
                      media="(min-width: 1025px) and (max-width: 9999px)">
              <img src="/images/bitget/banner-bg-2xl.8d79a9b3.svg" alt="banner-bg-2xl" loading="eager" decoding="async"
                   class="absolute z-0 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
            </picture>
            <div class="absolute z-20 top-1/2 left-1/2 w-full max-w-[1200px] h-full -translate-x-1/2 -translate-y-1/2">
              <img src="/images/bitget/banner-dollar.e03ebc10.svg" alt="banner-dollar" loading="lazy" decoding="async"
                   class="absolute -bottom-4 md:-bottom-8 2xl:-bottom-12 end-4 lg:end-[120px] w-[84px] md:w-[120px] 2xl:w-[150px]"><img
                src="/images/bitget/banner-point.a8a00057.svg" alt="banner-point" loading="lazy" decoding="async"
                class="absolute top-0 md:top-6 lg:top-5 end-12 md:end-[120px] lg:end-[140px] w-[60px] md:w-[80px] 2xl:w-[110px] offer_routeY180__z_GFt"><img
                src="/images/bitget/banner-point.a8a00057.svg" alt="banner-point" loading="lazy" decoding="async"
                class="absolute bottom-[57px] md:bottom-8 start-0 md:start-[70px] w-[40px] md:w-[80px] 2xl:w-[110px] offer_bannerSmallPointRotate__p6KlV">
            </div>
            <img src="/images/bitget/banner-left-arrow.49f066c3.svg" alt="banner-left-arrow" loading="lazy"
                 decoding="async"
                 class="absolute z-10 -bottom-8 md:-bottom-10 2xl:-bottom-[200px] -start-4 md:-start-[80px] 2xl:-start-[90px] w-[123px] h-[141px] md:w-[216px] md:h-[247px] offer_routeY180__z_GFt"><img
              src="/images/bitget/banner-right-arrow.13121691.svg" alt="banner-right-arrow" loading="lazy"
              decoding="async"
              class="absolute z-10 top-[-45px] md:top-[-35px] 2xl:top-0 -end-[70px] md:-end-[80px] w-[163px] h-[99px] md:w-[286px] md:h-[175px] offer_routeY180__z_GFt">
            <div
                class="relative z-30 flex flex-col justify-center h-full mx-auto max-w-[343px] md:max-w-[600px] lg:max-w-full overflow-hidden">
              <h1
                  class="my-0 mx-auto font-bold text-primaryText text-2xl md:text-[2.5rem] lg:text-5xl leading-8 md:leading-[48px] lg:leading-[57px] text-center">
                é‚€è«‹ 10 ä½å¥½å‹åŠ©åŠ›ï¼Œå³å¯é ˜å– <span class="text-[#FCE917]">20 USDT</span></h1>
              <p
                  class="mt-2 mb-0 mx-auto font-medium md:font-base text-primaryText text-sm md:text-xl leading-6 md:leading-7 text-center">
                æœ¬è¼ªåŠ©åŠ›å®Œæˆå¾Œï¼Œæ¯ä½å¥½å‹ä¹Ÿå¯é ˜ <span class="text-[#FCE917]">5 USDT</span></p>
            </div>
            <div class="md:hidden absolute z-40 top-3 -end-[6px] block lg:hidden">
              <div>
                <div
                    class="cursor-pointer h-[24px] bg-[#FFFFFF] rounded-s-[12px] px-[17px] font-[500] text-center text-[12px] leading-[24px] text-gray-800">
                  è¦å‰‡
                </div>
              </div>
              <div></div>
            </div>
          </div>
          <div class="mx-[16px] md:mx-[24px] lg:mx-[40px] xl:mx-auto max-w-[1200px]">
            <div class="offer_currentActivityBorderLinear__DmVOy relative rounded-[16px]">
              <div class="bg-bg rounded-[16px]">
                <div class="offer_currentActivityBgLinear__ACxZX rounded-[16px] pb-[32px] md:pb-[48px]">
                  <div
                      class="offer_statusHighLightLinear__deoJD relative top-[-1px] start-[-1px] inline-block  ltr:rounded-tl-[16px] rtl:rounded-tr-[16px] ltr:rounded-br-[16px] rtl:rounded-bl-[16px] py-[5px] md:py-[14px] px-[16px] md:ps-[24px] md:pe-[41px] max-w-[245px] md:max-w-none leading-[20px] text-xs md:text-base text-blackText">
                    é‚€è«‹ <strong class="px-[2px] font-bold">10 äºº</strong> ä»¥ç²å¾—çå‹µ
                  </div>
                  <div class="px-[16px] md:px-[24px]">
                    <div class="mt-[24px] md:mt-[32px] text-start">
                      <h3 class="flex my-0">
                        <div class="my-[6px] md:my-[2px] w-[3px] bg-[#00FFF1] me-[8px]"></div>
                        <span class="me-1 text-primaryText text-xl md:text-[1.75rem] leading-[28px] font-medium">å¥½å‹åŠ©åŠ›ä½ é ˜å–
                          <span class="border-dashed border-0 border-b-[1px] text-[#FCE917] cursor-pointer">20
                            USDT</span></span>
                        <div class="flex items-center cursor-pointer"></div>
                      </h3>
                      <p
                          class="mt-[4px] md:mt-[12px] ms-[11px] text-xs md:text-sm md:font-medium text-[#559EA6] leading-[18px] md:leading-[22px]">
                        æ¯é‚€è«‹ 1 ä½å¥½å‹åœ¨ Bitget è¨»å†Šä¸¦ç´¯è¨ˆäº¤æ˜“æ»¿ 50 USDTï¼Œå³è¦–ç‚ºåŠ©åŠ›æˆåŠŸ 1 æ¬¡ã€‚</p>
                    </div>
                    <div class="flex justify-center mt-2 gap-2 items-center" v-if="store.state.userInfo?.code">
                      <div class="demo-progress">
                        <el-progress :text-inside="true" :stroke-width="28" :percentage="state.percentageProcess"
                                     status="success"/>
                      </div>
                    </div>
                    <div
                        class="md:relative flex items-center mt-6 md:mt-6 gap-x-[10px] md:gap-x-0 mx-auto max-w-[311px]">
                      <div @click="onPopup"
                           class="relative w-full bg-[#00FFF1] rounded-[99px] py-[10px] text-center font-[600] cursor-pointer text-[14px] leading-[19px]  shadow-[0_6px] shadow-[#007A74]">
                        <img src="/images/bitget/btn-pointer.561cae66.png" alt="btn-pointer" loading="lazy"
                             decoding="async" class="absolute top-4 right-12 w-12 offer_btnPointer__89czm">
                        <span class="text-gray-800">ç™»å…¥ä¸¦é–‹å§‹é‚€è«‹</span>
                      </div>
                    </div>
                    <div
                        class="md:relative flex justify-end mt-10 md:mt-10 gap-x-[10px] md:gap-x-0 mx-auto max-w-[311px] cursor-pointer"
                        @click="openWhatsApp(0)">
                      <span class="text-black rounded-[99px] py-1 px-3 bg-[#FCE917] shadow-[0_4px] shadow-[#007A74]">ä¸‹è½½
                        whatsApp</span>

                    </div>
                    <div class="mt-[32px] md:mt-[56px]">
                      <h3 class="flex my-0">
                        <div class="my-[6px] md:my-[2px] w-[3px] bg-[#00FFF1] me-[8px]"></div>
                        <span
                            class="text-primaryText text-xl md:text-[1.75rem] leading-[28px] font-medium">å¦‚ä½•ç²å¾—çå‹µ</span>
                      </h3>
                      <div
                          class="flex flex-col md:flex-row justify-between items-start mt-[24px] md:mt-[42px] mx-[2px] md:mx-[24px] lg:mx-auto max-w-[1024px] text-start md:ltr:text-center md:rtl:text-center">
                        <div class="flex gap-x-4 md:gap-x-0 md:flex-col items-center"><img
                            src="/images/bitget/register.46f6bcda.svg" alt="register" loading="lazy" decoding="async"
                            class="w-[32px] md:w-[64px] h-[38px] md:h-[76px]"><label
                            class="md:mt-[6px] md:w-[180px] lg:w-[240px] text-primaryText text-sm md:text-base leading-5 md:leading-[22px]">â€Œé‚€è«‹å¥½å‹</label>
                        </div>
                        <div
                            class="md:flex-1 md:self-center ms-4 md:ms-0 my-1 md:my-0 border-dashed border-[#169784] border border-0 border-l-[1px] md:border-l-0 md:border-t-[1px] min-h-[32px] md:min-h-0">
                        </div>
                        <div class="flex gap-x-4 md:gap-x-0 md:flex-col items-center"><img
                            src="/images/bitget/success.2df18327.svg" alt="success" loading="lazy" decoding="async"
                            class="w-[32px] md:w-[64px] h-[38px] md:h-[76px]"><label
                            class="md:mt-[6px] md:w-[180px] lg:w-[240px] text-primaryText text-sm md:text-base leading-5 md:leading-[22px]">2
                          ä½å¥½å‹åŠ©åŠ›æˆåŠŸã€‚</label></div>
                        <div
                            class="md:flex-1 md:self-center ms-4 md:ms-0 my-1 md:my-0 border-dashed border-[#169784] border border-0 border-l-[1px] md:border-l-0 md:border-t-[1px] min-h-[32px] md:min-h-0">
                        </div>
                        <div class="flex gap-x-4 md:gap-x-0 md:flex-col items-center"><img
                            src="/images/bitget/rewards.276b009a.svg" alt="rewards" loading="lazy" decoding="async"
                            class="w-[32px] md:w-[64px] h-[38px] md:h-[76px]"><label
                            class="md:mt-[6px] md:w-[180px] lg:w-[240px] text-primaryText text-sm md:text-base leading-5 md:leading-[22px]">çå‹µåˆ°å¸³ï¼Œæ‚¨é ˜å–
                          20 USDT å¥½å‹é ˜å– 5 USDTã€‚</label></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="px-5 md:mx-[24px] lg:mx-[40px] mt-[88px] xl:mx-auto xl:max-w-[1200px]">
            <h3 class="mt-[0] font-[500] text-[40px] leading-[54px] mb-[24px] text-whiteText">æ¢æ¬¾èˆ‡æ¢ä»¶</h3>
            <div class="offer_desWrapper__xlES_">
              <div>
                <div class="font-[500] text-[16px] leading-[24px] text-whiteText my-[16px]">1. å¦‚ä½•åƒèˆ‡æ´»å‹•ï¼Ÿ</div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">1.1 åˆ†äº«ä¸¦é‚€è«‹
                  10 åå¥½å‹ï¼Œæ¯ä½å¥½å‹å‡äº¤æ˜“è¶…é 50 USDT å³ç®—æˆåŠŸåŠ©åŠ›ã€‚æ‚¨å¯ç²å¾—20 USDTé«”é©—é‡‘çå‹µï¼Œæ¯ä½å¥½å‹ç²å¾—5 USDTé«”é©—é‡‘çå‹µã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">1.2
                  è‹¥æœ¬è¼ªåŠ©åŠ›çµæŸå‰ï¼Œåƒ…æœ‰ 1 ä½å¥½å‹æˆåŠŸåŠ©åŠ›ï¼Œå‰‡æœ¬è¼ªåŠ©åŠ›å¤±æ•—ï¼Œæ‚¨èˆ‡è©²å¥½å‹å‡ç„¡æ³•ç²å¾—çå‹µã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">1.3
                  é€²å…¥é é¢é»æ“Šå ±åå¾Œï¼Œé–‹å•Ÿæ´»å‹•ã€‚æ¯æ¬¡åŠ©åŠ›é™åˆ¶ 10 å¤©å…§å®Œæˆï¼Œæå‰å®ŒæˆåŠ©åŠ›æˆ–è€…æœ¬è¼ªæœªå®ŒæˆåŠ©åŠ›ï¼Œå¯ä»¥ç™¼èµ·æ–°çš„ä¸€è¼ªåŠ©åŠ›æ´»å‹•ã€‚
                </div>
              </div>
              <div>
                <div class="font-[500] text-[16px] leading-[24px] text-whiteText my-[16px]">2. çå‹µè¦å‰‡</div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">2.1
                  äº¤æ˜“é«”é©—é‡‘å°‡ç™¼æ”¾è‡³æ‚¨å’Œå¥½å‹çš„å¡åˆ¸ä¸­å¿ƒï¼Œå¡åˆ¸ä½¿ç”¨æœ‰æ•ˆæœŸç‚º 5 å¤©ã€‚è«‹åŠæ™‚ä½¿ç”¨ã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">2.2
                  ä»»å‹™å®Œæˆå¾Œï¼Œçå‹µç™¼æ”¾éœ€äººå·¥å¯©æ ¸ï¼Œè‹¥è¶…é 3 å€‹å·¥ä½œå¤©ä»æœªåˆ°å¸³ï¼Œè«‹è¯ç¹«å®¢æœã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">2.3
                  è‹¥ç”¨æˆ¶æƒ¡æ„åƒèˆ‡æœ¬æ´»å‹•ï¼ˆåŒ…æ‹¬ä½†ä¸é™æ–¼æ´—éŒ¢ã€è™›å‡äº¤æ˜“ã€æƒ¡æ„å¥—ç¾ç­‰è¡Œç‚ºï¼‰ï¼Œä¸€ç¶“ç™¼ç¾ï¼ŒBitget
                  æœ‰æ¬Šå°è©²ç”¨æˆ¶çš„å¸³æˆ¶é€²è¡Œç•°å¸¸æ¨™è¨»ï¼Œä¸¦çµ¦äºˆç›¸æ‡‰æ‡²ç½°ã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">2.4 Bitget
                  å°‡å°æ‰€æœ‰ç”¨æˆ¶é€²è¡Œå¯©æŸ¥ï¼Œå°æ–¼ä½¿ç”¨ä»»ä½•æŠ€è¡“æ‰‹æ®µè¨»å†Šå’Œåƒèˆ‡ï¼ˆåŒ…æ‹¬ä½†ä¸é™æ–¼é›»å­ã€æ©Ÿå™¨äººã€é‡è¤‡ã€è‡ªå‹•åŒ–ç­‰é¡ä¼¼æ‰‹æ®µï¼‰ä»¥å¯¦ç¾è‡ªå‹•æˆ–é‡è¤‡è¨»å†Šç›®çš„çš„ç”¨æˆ¶ï¼Œå…¶æ‰€æœ‰è¨»å†Šå’Œæ´»å‹•çå‹µç«‹å³å¤±æ•ˆã€‚å³ä½¿è©²ç”¨æˆ¶ä¸¦éæ‰€æœ‰è¨»å†Šè³‡è¨Šã€åƒèˆ‡æ´»å‹•é€”å¾‘ï¼Œéƒ½æ¡ç”¨æ­¤é¡æƒ¡æ„æ‰‹æ®µï¼Œä¹Ÿéƒ½åˆ¤å®šç‚ºå¤±æ•ˆã€‚
                </div>
              </div>
              <div>
                <div class="font-[500] text-[16px] leading-[24px] text-whiteText my-[16px]">3. è£œå……èªªæ˜</div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">3.1
                  åŒä¸€æ™‚é–“å…§ï¼Œä½ åªèƒ½é¸æ“‡åƒèˆ‡æœ¬æ´»å‹•æˆ–å¹¸é‹å¤§è½‰ç›¤æ´»å‹•ï¼Œä¸å¯åŒæ™‚åƒèˆ‡å…©å€‹æ´»å‹•ã€‚è‹¥æ‚¨å·²åƒèˆ‡å¹¸é‹å¤§è½‰ç›¤æ´»å‹•ï¼Œåœ¨ç¢ºèªåƒèˆ‡æœ¬æ´»å‹•æ™‚ï¼Œç³»çµ±å°‡è‡ªå‹•ç‚ºæ‚¨çµæŸå¹¸é‹å¤§è½‰ç›¤æ´»å‹•é€²åº¦ã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">3.2 Bitget
                  åˆä½œå¤¥ä¼´åŠå°ˆå±¬åˆå¤¥äººä¸é©ç”¨æœ¬æ´»å‹•ã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">3.3
                  å­å¸³æˆ¶ä¸èƒ½ä½œç‚ºç¨ç«‹å¸³æˆ¶åƒèˆ‡è©²æ´»å‹•ï¼Œä¸”æ•¸æ“šä¸ä½µå…¥ä¸»å¸³æˆ¶ã€‚
                </div>
                <div class="font-[400] text-[14px] leading-[22px] text-[#EFF1F1] mb-[8px] lg:text-[#656E6F]">3.4 ä»¥ä¸Šè¦å‰‡è‡ª
                  2023 å¹´ 11 æœˆ 9 æ—¥ 18:00ï¼ˆUTC+8ï¼‰èµ·ç”Ÿæ•ˆã€‚Bitget ä¿ç•™å°æœ¬æ´»å‹•çš„æœ€çµ‚è§£é‡‹æ¬Šã€‚
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <el-dialog @close="resetFields" destroy-on-close v-model="state.dialogPhoneInput"
               class="md:w-[50%] lg:w-[40%] xl:w-[30%] w-[85%] rounded-2xl" center align-center :show-close="false">
      <div class="text-lg mb-4 font-bold">
        è¯·å¡«å…¥æ‰‹æœºå·ç ç«‹å³é‚€è¯·å¥½å‹
      </div>
      <el-form ref="ruleFormRef" :model="state.form" :rules="formRules">
        <el-form-item prop="phone">
          <el-input size="large" type="text" v-model="state.form.phone" placeholder="ç”µè¯å·ç "></el-input>
        </el-form-item>
      </el-form>
      <template #footer>
        <span class="dialog-footer">
          <el-button :loading="isProcessing" class="bg-gray-100 w-32 h-9 rounded-lg" @click="onSubmit(ruleFormRef)">
            <span class="text-base text-gray-800">ç¡®è®¤</span>
          </el-button>
        </span>
      </template>
    </el-dialog>

    <!-- dialog Prompt -->
    <el-dialog destroy-on-close v-model="state.promptDialog"
               class="md:w-[50%] lg:w-[40%] xl:w-[30%] w-[85%] rounded-2xl bg-gradient-to-r from-green-200 to-green-400"
               center
               align-center :show-close="false">
      <div class="text-xl text-center font-bold">
        ç«‹å³å‰å¾€é¢†å–
      </div>
      <template #footer>
        <span class="dialog-footer">
          <el-button :loading="isProcessing" class="bg-[#00FFF1] w-44 h-9 rounded-2xl" @click="onConfirm">
            <span class="text-base text-gray-800">ç¡®è®¤</span>
          </el-button>
        </span>
      </template>
    </el-dialog>
    <!-- dialog Prompt Submit first time -->
    <el-dialog destroy-on-close v-model="state.promptFirstTime"
               class="md:w-[50%] lg:w-[40%] xl:w-[30%] w-[85%] rounded-2xl" center align-center :show-close="false">
      <div class="text-xl text-center font-bold">
        å¦‚æœæ²¡æœ‰å®‰è£…whatsApp,è¯·å‰å¾€ä¸‹è½½
      </div>
      <template #footer>
        <span class="dialog-footer">
          <el-button :loading="isProcessing" class="bg-[#00FFF1] w-44 h-9 rounded-2xl"
                     @click="state.promptFirstTime = !state.promptFirstTime">
            <span class="text-base text-gray-800">ç¡®è®¤</span>
          </el-button>
        </span>
      </template>
    </el-dialog>
  </div>
</template>
<script setup lang="ts">
import { reactive, watch, onMounted } from 'vue';
import formHelper, { IRule } from "../libraries/elementUiHelpers/formHelper";
import useVariable from '../composables/useVariable';
import notificationHelper from '../libraries/elementUiHelpers/notificationHelper';
import EnumMessageType from '../models/enums/enumMessageType';
import store from '../store';

const { isProcessing, ruleFormRef, api, route } = useVariable();
const state = reactive({
  form: {
    phone: null,
    url: '',
    link: '',
    click: 0,
  },
  dialogPhoneInput: false,
  promptDialog: false,
  promptFirstTime: false,
  percentageProcess: 0,
});
const resetFields = () => {
  state.form.phone = null;
  state.dialogPhoneInput = false;
};
const onPopup = () => {
  if (store.state.userInfo?.phone) {
    getIncClick();
    return window.location.href = state.form.url
  }
  state.dialogPhoneInput = true;
};
const submitProcess = async () => {
  isProcessing.value = true;
  const request = {
    phone: state.form.phone,
    code: route.query?.code,
  }
  try {
    const response = await api.savePhone(request);
    isProcessing.value = false;
    if (response.code !== 200) {
      notificationHelper.notification(response.message, EnumMessageType.Error);
    } else {
      notificationHelper.notification('æˆåŠŸåœ°!', EnumMessageType.Success);
      store.commit('SET_CLICK', 1);
      openWhatsApp(1, response.data.code);
      state.promptFirstTime = true;
    }
    resetFields();
  } catch (error) {
    isProcessing.value = false;
  }
};
const getLink = async () => {
  const response = await api.getLink();
  if (response.code === 200) {
    state.form.link = response.data.link;
  }
};
const rules: Record<string, IRule> = ({
  phone: { required: true, message: 'ç”µè¯ä¸ºå¿…å¡«é¡¹' },
});
const formRules = formHelper.getRules(rules);
const onSubmit = formHelper.getSubmitFunction(submitProcess);
const openWhatsApp = (type = 1, code = '') => {
  const protocol = window.location.protocol;
  const domain = window.location.hostname;
  const port = window.location.port;
  const fullDomain = protocol + '//' + domain + (port ? ':' + port : '');
  let content = "ç‚¹å‡»ä¸‹é¢é“¾æ¥ğŸ‘‡ğŸ‘‡ğŸ‘‡,é€šè¿‡å‚æ´»åŠ¨æ¥èµšé’±å§ã€‚";
  if (type === 1) {
    content += "\n" + `${ fullDomain }?code=` + code + "\n";
    state.form.url = 'whatsapp://send/' + `?text=${ encodeURIComponent(content) }`;
    const obj = { phone: state.form.phone, code: code, url: state.form.url };
    store.commit('SET_USERINFO', obj);
    window.location.href = state.form.url;
  } else {
    content += "\n" + `${ fullDomain }/?code=${ store.state.userInfo?.code }`;
    window.location.href = 'https://api.whatsapp.com/send' + `?text=${ encodeURIComponent(content) }`;
  }
}
const getIncClick = async () => {
  const request = {
    phone: store.state.userInfo?.phone,
    code: store.state.userInfo?.code,
  }
  const response = await api.incClick(request);
  if (response.code === 200) {
    store.commit('SET_CLICK', 1);
  }
}
const setIntervalFunc = (num: number) => {
  const setInterValDialog = setInterval(() => {
    state.percentageProcess = num;
    clearInterval(setInterValDialog);
    if(state.form.click === 10) {
      state.promptDialog = true;
    }
  }, 2000);
};
watch(() => [state.form.click, store.state?.click], () => {
  if (state.form.click === 1) {
    state.percentageProcess = 0;
  } else if (state.form.click === 2) {
    setIntervalFunc(10)
  } else if (state.form.click === 3) {
    state.percentageProcess = 10
  } else if (state.form.click === 4) {
    setIntervalFunc(20)
  } else if (state.form.click === 5) {
    state.percentageProcess = 20;
  } else if (state.form.click === 6) {
    setIntervalFunc(30)
  } else if (state.form.click === 7) {
    state.percentageProcess = 30
  } else if (state.form.click === 8) {
    setIntervalFunc(50)
  } else if (state.form.click === 9) {
    setIntervalFunc(90)
  } else if (state.form.click === 10) {
    setIntervalFunc(100);
  }
  state.form.click = store.state.click;
})
const onConfirm = () => {
  state.promptDialog = false;
  window.location.href = `${ state.form.link }`;
};
onMounted(() => {
  getLink();
  state.form.click = store.state?.click;
  state.form.phone = store.state.userInfo?.phone;
  state.form.url = store.state.userInfo?.url
});

</script>
<style lang="scss">
.offer_bgLinear__vFptl {
  background: linear-gradient(175.1deg, rgba(8, 139, 139, .2) 7.38%, rgba(13, 14, 14, 0) 72.52%);
}
.offer_currentActivityBgLinear__ACxZX {
  background: linear-gradient(180deg, #17363a, rgba(23, 54, 58, 0));
  background-position-x: initial;
  background-position-y: initial;
  background-size: initial;
  background-origin: initial;
  background-clip: initial;
}

.offer_btnPointer__89czm {
  -webkit-user-drag: none;
  animation: offer_btnPointer__89czm .8s ease-in-out infinite;
  pointer-events: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

@keyframes offer_btnPointer__89czm {
  0% {
    transform: translate(6px, 6px);
  }

  50% {
    transform: translate(-6px, -6px);
  }

  100% {
    transform: translate(6px, 6px);
  }
}

.offer_helperLinear__lMbnf {
  background-clip: padding-box, border-box;
  background-image: linear-gradient(144.96deg, #364046, #364046), linear-gradient(144.96deg, rgba(157, 221, 231, .74) 9.55%, rgba(152, 228, 231, .07) 86.19%);
  background-origin: padding-box, border-box;
  border: 1px solid transparent;
}

.rounded-1\/2 {
  border-radius: 50%;
}

.el-dialog__body {
  padding: calc(var(--el-dialog-padding-primary) + 0px) var(--el-dialog-padding-primary);
}

.demo-progress .el-progress--line {
  margin-top: 15px;
  width: 320px;
}

.el-message-box__btns .el-button--primary {
  @apply bg-blue-400;
}
</style>
